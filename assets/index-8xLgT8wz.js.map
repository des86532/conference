{"version":3,"file":"index-8xLgT8wz.js","sources":["../../js/game.js"],"sourcesContent":["// ==================== Game Initialization ====================\nconsole.log('ğŸš€ ç³»çµ±åˆå§‹åŒ–å®Œæˆ. ä»»å‹™é–‹å§‹.');\n\n// === Voice Audio System ===\nconst sceneAudio = new Audio();\nsceneAudio.preload = 'auto';\nsceneAudio.volume = 1.0;\n\n// Helper to resolve assets respecting Vite base (works even if BASE_URL is relative)\nconst baseAssetUrl = (() => {\n    const baseEnv = import.meta?.env?.BASE_URL || '/';\n    // Ensure absolute URL so URL constructor never throws\n    return new URL(baseEnv, window.location.origin).href;\n})();\n\nconst toAssetUrl = (path) => new URL(path, baseAssetUrl).href;\n\n// Helper for selecting elements\nconst $ = (selector) => document.querySelector(selector);\nconst $$ = (selector) => document.querySelectorAll(selector); // For multiple lists\n\n// Messaging System\nfunction showMessage(type, text) {\n    const messageEl = $('#message');\n    \n    if (messageEl) {\n        messageEl.className = 'w-full p-4 mt-4 text-lg font-bold text-center border rounded-lg message';\n        if (type === 'success') {\n            messageEl.classList.add('bg-green-100', 'dark:bg-green-900/30', 'border-green-500', 'text-green-600', 'dark:text-green-400');\n        } else {\n            messageEl.classList.add('bg-red-100', 'dark:bg-red-900/30', 'border-red-500', 'text-red-600', 'dark:text-red-400');\n        }\n        messageEl.textContent = text;\n        messageEl.classList.add('active');\n        setTimeout(() => messageEl.classList.remove('active'), 5000);\n    }\n}\n\n// ==================== Narrative System ====================\nlet currentStoryIndex = 0;\nlet furthestStoryIndex = 0;\nconst sceneHintsShown = new Set();\nlet story10PasswordAttempted = false; // è·Ÿè¹¤ç”¨æˆ¶æ˜¯å¦åœ¨ Story 10 è¼¸å…¥éå¯†ç¢¼\nconst story = [\n    // === å‰è¨€ ===\n    { \n        id: 0, \n        text: \"çœ‹ä¾†é€™å ´åˆ†äº«æœƒçš„å‘½é‹æŒæ¡åœ¨ä½ æ‰‹è£¡äº†... è®“æˆ‘çœ‹çœ‹ä½ æœ‰å¤šå°‘æœ¬äº‹ã€‚\", \n        autoNext: false \n    },\n    { \n        id: 1, \n        text: \"æƒ³è§£é™¤æˆ‘çš„ç‚¸å½ˆï¼Ÿé™¤éä½ èƒ½çœ‹ç©¿é€™äº›ç¨‹å¼ç¢¼çš„ç ´ç¶»... å°å¿ƒåˆ¥è®“é€™è£¡ <span class='text-red-500 animate-pulse'>çˆ†ç‚¸</span> äº†\", \n        autoNext: false\n    },\n    \n    // === é—œå¡ä¸€ï¼šConsole ===\n    { \n        id: 2, \n        text: \"çœ‹çœ‹ä½ å‰©ä¸‹å¤šå°‘ 'æ™‚é–“' å§ï¼<br>åˆ¥å†æ‰‹å‹• log äº†... è©¦è‘—è®“ä½ çš„ Console <span class='text-yellow-400'>ã€é•·å‡ºä¸€é›™çœ¼ç›ã€</span> ä¾†ç›¯è‘—å®ƒå§ï¼\", \n        autoNext: false\n    },\n    \n    // === é—œå¡äºŒï¼šApplication ===\n    { \n        id: 3, \n        text: \"ç«Ÿç„¶è¢«ä½ ç™¼ç¾äº†çœŸå¯¦çš„æ™‚é–“... ä¸ç°¡å–®å˜›ã€‚<br>ä½†æ¥ä¸‹ä¾†çš„æŒ‘æˆ°å¯æ²’é‚£éº¼ç›´æ¥... æœ‰äº› <span class='text-purple-400'>è³‡æ–™</span> è—åœ¨ä½ æ„æƒ³ä¸åˆ°çš„åœ°æ–¹...\", \n        triggerLevel: 1\n    },\n    {\n        id: 4,\n        text: \"è½èªªéã€è³‡æ–™è—åœ¨å››é¢å…«æ–¹ã€å—ï¼Ÿ<br><span class='text-purple-400'>Cookies</span>ã€<span class='text-purple-400'>Local Storage</span>ã€<span class='text-purple-400'>Session Storage</span>ï¼Œç”šè‡³ <span class='text-purple-400'>IndexedDB</span>... æ¯å€‹è§’è½éƒ½å¯èƒ½è—è‘—ç·šç´¢ã€‚å» <span class='text-purple-400 font-bold'>Application é¢æ¿</span> ä»”ç´°æŒ–æ˜å§ï¼\",\n        autoNext: false  // é—œå¡äºŒå®Œæˆå¾Œæ‰èƒ½æ¨é€²åˆ° Story 5\n    },\n    \n    // === é—œå¡ä¸‰ï¼šPerformance ===\n    {\n        id: 5,\n        text: \"ç«Ÿç„¶è¢«ä½ æ‰¾åˆ°äº†æ‰€æœ‰å„²å­˜ä½ç½®... ä¸éï¼Œæ¥ä¸‹ä¾†å¯æ²’é‚£éº¼ç°¡å–®ã€‚<br>æ„Ÿè¦ºåˆ°äº†å—ï¼Ÿä½ çš„ç€è¦½å™¨æ­£åœ¨è®Šæ…¢... <span class='text-yellow-400 animate-pulse'>æ•ˆèƒ½</span> å•é¡Œå¯ä¸å¥½è§£æ±ºå–”ï¼\",\n        triggerLevel: 2\n    },\n    {\n        id: 6,\n        text: \"å“ˆå“ˆï¼Œä½ çš„é é¢å¡æˆé€™æ¨£... æƒ³çŸ¥é“åŸå› ï¼Ÿ<br>å» <span class='text-yellow-400 font-bold'>Performance é¢æ¿</span> éŒ„è£½ä¸€æ®µå§ï¼çœ‹çœ‹æ˜¯ä»€éº¼ <span class='text-red-500'>é•·ä»»å‹™</span> åœ¨æ‹–ç´¯ä½ ...\",\n        autoNext: false  // é—œå¡ä¸‰å®Œæˆå¾Œæ‰èƒ½æ¨é€²åˆ° Story 7\n    },\n    \n    // === é—œå¡å››ï¼šNetwork ===\n    {\n        id: 7,\n        text: \"å˜–... é€£æ•ˆèƒ½ç“¶é ¸éƒ½è¢«ä½ æ‰¾åˆ°äº†ï¼Ÿ<br>é‚£å°±è®“ä½ çš„ç¶²è·¯å……æ»¿ <span class='text-green-400'>é›œè¨Š</span> å§ï¼åœ¨æ··äº‚ä¸­ï¼Œä½ èƒ½æ‰¾åˆ°çœŸæ­£æœ‰ç”¨çš„è³‡è¨Šå—ï¼Ÿ\",\n        triggerLevel: 3\n    },\n    {\n        id: 8,\n        text: \"ä½ æ‡‰è©²å·²ç¶“è¢«é‚£äº› <span class='text-green-400'>é›œè¨Šè«‹æ±‚</span> ç…©æ­»äº†å§ï¼Ÿ<br>è©¦è‘—åœ¨ <span class='text-green-400 font-bold'>Network é¢æ¿</span> è£¡ <span class='text-green-400'>éæ¿¾é›œè¨Š</span>... æ‰¾åˆ°æˆåŠŸçš„è«‹æ±‚ï¼Œå®ƒæœƒå‘Šè¨´ä½ ä¸‹ä¸€æ­¥è©²æ€éº¼åš...\",\n        autoNext: false  // ä¸è¨­ triggerLevelï¼Œè®“ä½¿ç”¨è€…æœ‰æ™‚é–“çœ‹æç¤º\n    },\n    {\n        id: 9,\n        text: \"æ‰¾åˆ°æç¤ºäº†ï¼Ÿé‚£å°±ç…§è‘—åšå§ï¼<br>ä½¿ç”¨ <span class='text-green-400 font-bold'>Local Overrides</span> ä¾†æ”¹å¯«å¤±æ•—çš„ API... æˆåŠŸçš„è©±ï¼Œéš±è—çš„å¯†ç¢¼å°±æœƒæµ®ç¾...\",\n        autoNext: false  // é—œå¡å››å®Œæˆå¾Œæ‰èƒ½æ¨é€²åˆ° Story 10\n    },\n    \n    // === é—œå¡äº”ï¼šSources ===\n    // æ–°å¢éæ¸¡å°è©± (ID 10)\n    {\n        id: 10,\n        text: \"å“¼ï¼Œç«Ÿç„¶çœŸçš„è¢«ä½ æ‰¾åˆ°äº†å®Œæ•´çš„å¯†ç¢¼ç¢ç‰‡... <br>ä¸éåˆ¥å¾—æ„çš„å¤ªæ—©ã€‚<br>æ—¢ç„¶ä½ é€™éº¼æœ‰è‡ªä¿¡ï¼Œé‚£å°±<span class='text-red-400 font-bold'>è¼¸å…¥å¯†ç¢¼</span>è©¦è©¦çœ‹å•Šï¼Ÿæˆ‘è³­ä½ éä¸äº†æœ€å¾Œé€™é—œï¼\",\n        triggerLevel: 4 \n    },\n    // ID 11: é‚è¼¯é–æç¤º - é§­å®¢æ—©å·²é æ–™\n    {\n        id: 11,\n        text: \"å“ˆå“ˆå“ˆï¼é©šè¨å—ï¼Ÿ<br>ä½ ä»¥ç‚ºæ‰¾åˆ°å¯†ç¢¼å°±çµæŸäº†ï¼Ÿå¤ªå¤©çœŸäº†ï¼<br>é€™æ˜¯æˆ‘ç²¾å¿ƒæº–å‚™çš„ <span class='text-red-500'>é‚è¼¯é™·é˜±</span>ã€‚<br>æƒ³è§£é–‹å®ƒï¼Ÿå» <span class='text-yellow-400 font-bold'>Sources é¢æ¿</span> çœ‹çœ‹ä½ èƒ½åšä»€éº¼å§ï¼\",\n        autoNext: false\n    },\n    \n    // === æœ€çµ‚å‹åˆ© ===\n    {\n        id: 12,\n        text: \"ä¸å¯èƒ½... æˆ‘çš„é‚è¼¯é–... ç«Ÿç„¶è¢«ç ´è§£äº†ï¼Ÿï¼<br><span class='text-green-500 text-xl font-bold'>ğŸ‰ æ­å–œï¼ä½ å·²æˆåŠŸå®ˆè­·äº†é€™å ´åˆ†äº«æœƒï¼</span>\",\n        triggerLevel: 5,  // åªæœ‰å®Œæˆé—œå¡äº”å¾Œæ‰èƒ½åˆ°é”\n        isFinal: true\n    }\n];\n\nfunction updateVillainMessage(text) {\n    const desktopMsg = $('#desktop-villain-msg');\n    const mobileMsg = $('#mobile-villain-msg');\n    const formattedText = `<span class=\"text-green-500 font-bold mr-2\">&gt;</span>\"${text}\"`;\n    \n    if (desktopMsg) desktopMsg.innerHTML = formattedText;\n    if (mobileMsg) mobileMsg.innerHTML = formattedText;\n}\n\nfunction playSceneAudio(scene) {\n    if (!scene || scene.id === undefined || scene.id === null) return;\n    sceneAudio.pause();\n    sceneAudio.currentTime = 0;\n    sceneAudio.src = toAssetUrl(`audio/id-${scene.id}.mp3`);\n    sceneAudio.play().catch(() => {});\n}\n\nfunction logSceneHints(sceneId) {\n    switch (sceneId) {\n        case 2:\n            console.log('%cğŸ’¡ é§­å®¢æç¤º:', 'color: #fbbf24; font-size: 16px; font-weight: bold;');\n            console.log('%cè©¦è‘—åœ¨ Console é¢æ¿æ‰¾åˆ°ã€Œçœ¼ç›åœ–ç¤ºã€ğŸ‘ï¸ (Create Live Expression)', 'color: #60a5fa; font-size: 14px;');\n            console.log('%cç„¶å¾Œè¼¸å…¥é€™å€‹è®Šæ•¸ä¾†ç›£æ§æ™‚é–“:', 'color: #a78bfa; font-size: 14px;');\n            console.log('%cwindow.game.timer', 'color: #10b981; font-size: 18px; font-weight: bold; background: #1f2937; padding: 8px; border-radius: 4px;');\n            console.log('%cğŸ’¡ æç¤º: Live Expression æœƒå³æ™‚æ›´æ–°æ•¸å€¼ï¼Œä¸ç”¨ä¸€ç›´é‡æ–°è¼¸å…¥ï¼', 'color: #fbbf24; font-size: 12px; font-style: italic;');\n            break;\n        case 4:\n            console.log('%cğŸ’¡ é§­å®¢æç¤º:', 'color: #fbbf24; font-size: 16px; font-weight: bold;');\n            console.log('%cå¯†ç¢¼ç¢ç‰‡åˆ†æ•£åœ¨ 4 å€‹å„²å­˜ä½ç½®ï¼Œæ¯å€‹ä½ç½®è—è‘—ä¸€å€‹æç¤º...', 'color: #a78bfa; font-size: 14px;');\n            console.log('%cæª¢æŸ¥ä»¥ä¸‹ä½ç½®ï¼ˆApplication é¢æ¿ï¼‰:', 'color: #60a5fa; font-size: 14px;');\n            console.log('%c  1. Cookies', 'color: #10b981; font-size: 13px;');\n            console.log('%c  2. Local Storage', 'color: #10b981; font-size: 13px;');\n            console.log('%c  3. Session Storage', 'color: #10b981; font-size: 13px;');\n            console.log('%c  4. IndexedDB (database: DevToolsDB)', 'color: #10b981; font-size: 13px;');\n            console.log('%cæ‰¾åˆ° 4 å€‹æç¤ºå¾Œï¼Œçµ„åˆèµ·ä¾†ä¸¦åœ¨ Console é©—è­‰:', 'color: #a78bfa; font-size: 14px;');\n            console.log('%cwindow.game.verifyLevel2(\"ä½ çµ„åˆçš„å®Œæ•´ç¢ç‰‡\")', 'color: #10b981; font-size: 16px; font-weight: bold; background: #1f2937; padding: 8px; border-radius: 4px;');\n            break;\n        case 6:\n            console.log('%cğŸ’¡ é§­å®¢æç¤º:', 'color: #fbbf24; font-size: 16px; font-weight: bold;');\n            console.log('%cé é¢å¡é “ï¼Ÿè©¦è©¦ Performance é¢æ¿ï¼', 'color: #60a5fa; font-size: 14px;');\n            console.log('%cæ­¥é©Ÿ:', 'color: #a78bfa; font-size: 14px;');\n            console.log('%c  1. é–‹å•Ÿ Performance é¢æ¿', 'color: #10b981; font-size: 13px;');\n            console.log('%c  2. é»æ“ŠéŒ„è£½æŒ‰éˆ•ï¼ˆåœ“é»åœ–ç¤ºï¼‰', 'color: #10b981; font-size: 13px;');\n            console.log('%c  3. ç­‰å¾… 3-5 ç§’å¾Œåœæ­¢', 'color: #10b981; font-size: 13px;');\n            console.log('%c  4. å°‹æ‰¾ç´…è‰²çš„ Long Taskï¼ˆè¶…é 50ms çš„ä»»å‹™ï¼‰', 'color: #10b981; font-size: 13px;');\n            console.log('%c  5. é»æ“Šè©²ä»»å‹™ï¼Œåœ¨ Summary æ¨™ç±¤ä¸­é»æ“Šå‡½å¼åç¨±ï¼ˆè·³è½‰åˆ° Sourcesï¼‰', 'color: #10b981; font-size: 13px;');\n            console.log('%c  6. æŸ¥çœ‹å®ƒçš„ç¨‹å¼ç¢¼è¨»é‡‹ï¼Œè§£æ³•å°±è—åœ¨é‚£è£¡...', 'color: #fbbf24; font-size: 14px; font-weight: bold;');\n            break;\n        case 8:\n            console.log('%cğŸ’¡ é§­å®¢æç¤º:', 'color: #fbbf24; font-size: 16px; font-weight: bold;');\n            console.log('%cé–‹å•Ÿ Network é¢æ¿ï¼Œè§€å¯Ÿé‚£äº›é »ç¹çš„ request...', 'color: #60a5fa; font-size: 14px;');\n            console.log('%cæ­¥é©Ÿ:', 'color: #a78bfa; font-size: 14px;');\n            console.log('%c  1. å³éµé»æ“Šé›œè¨Šè«‹æ±‚ â†’ Block request URL/domain', 'color: #10b981; font-size: 13px;');\n            console.log('%c  2. æ‰¾åˆ°æˆåŠŸçš„ APIï¼ŒæŸ¥çœ‹ Response...', 'color: #fbbf24; font-size: 14px;');\n            break;\n        case 9:\n            console.log('%cğŸ’¡ é§­å®¢æç¤º:', 'color: #fbbf24; font-size: 16px; font-weight: bold;');\n            console.log('%cä½¿ç”¨ Local Overrides ä¾†æ”¹å¯« API responseï¼', 'color: #60a5fa; font-size: 14px;');\n            console.log('%cæ­¥é©Ÿ:', 'color: #a78bfa; font-size: 14px;');\n            console.log('%c  1. Sources é¢æ¿ â†’ Overrides â†’ Enable Local Overrides', 'color: #10b981; font-size: 13px;');\n            console.log('%c  2. Network é¢æ¿ â†’ æ‰¾åˆ°ç›®æ¨™ API â†’ å³éµ â†’ Override content', 'color: #10b981; font-size: 13px;');\n            console.log('%c  3. ç·¨è¼¯å…§å®¹è®“ API æˆåŠŸè¿”å›ï¼ˆåƒè€ƒæç¤ºæª”çš„èªªæ˜ï¼‰', 'color: #10b981; font-size: 13px;');\n            console.log('%c  4. é‡æ–°è¼‰å…¥é é¢ï¼Œçœ‹çœ‹æœƒç™¼ç”Ÿä»€éº¼...', 'color: #fbbf24; font-size: 14px; font-weight: bold;');\n            break;\n        case 11:\n            console.clear();\n            console.error('âŒ Access Denied: Logic Verification Failed');\n            console.warn('âš ï¸ ç³»çµ±æç¤º: æª¢æ¸¬åˆ°ç•°å¸¸çš„é‚è¼¯åˆ¤æ–·ã€‚');\n            console.info('ğŸ’¡ Debug æŒ‡å¼•: è«‹åœ¨ Sources é¢æ¿ä¸­æª¢æŸ¥ `submitPassword` å‡½å¼ï¼Œå°‹æ‰¾ `isSystemIntegrityCheckPassed` è®Šæ•¸ã€‚');\n            break;\n        default:\n            break;\n    }\n}\n\nfunction canAdvanceTo(index) {\n    if (index <= currentStoryIndex || index >= story.length) return false;\n    const nextScene = story[index];\n    if (!nextScene) return false;\n    if (nextScene.triggerLevel) {\n        const level = challenges.find(c => c.id === nextScene.triggerLevel);\n        if (!level || !level.completed) return false;\n    }\n    if (nextScene.triggerLevels) {\n        const anyCompleted = nextScene.triggerLevels.some(levelId => {\n            const level = challenges.find(c => c.id === levelId);\n            return level && level.completed;\n        });\n        if (!anyCompleted) return false;\n    }\n    return true;\n}\n\nfunction canAdvanceFromCurrent() {\n    const nextIndex = currentStoryIndex + 1;\n    \n    // ç‰¹æ®Šè™•ç†ï¼šStory 10 -> Story 11 éœ€è¦ç”¨æˆ¶è¼¸å…¥éå¯†ç¢¼\n    if (currentStoryIndex === 10 && nextIndex === 11 && !story10PasswordAttempted) {\n        return false;\n    }\n    \n    if (nextIndex <= furthestStoryIndex) return nextIndex < story.length;\n    return canAdvanceTo(nextIndex);\n}\n\nfunction syncNavigation() {\n    const desktopNext = $('#desktop-next-btn');\n    const mobileNext = $('#mobile-next-btn');\n    const desktopPrev = $('#desktop-prev-btn');\n    const mobilePrev = $('#mobile-prev-btn');\n    const canGoPrev = currentStoryIndex > 0;\n    const canGoNext = canAdvanceFromCurrent();\n\n    [desktopPrev, mobilePrev].forEach(btn => {\n        if (btn) {\n            btn.dataset.active = canGoPrev;\n            btn.disabled = !canGoPrev;\n        }\n    });\n\n    [desktopNext, mobileNext].forEach(btn => {\n        if (btn) {\n            btn.dataset.active = canGoNext;\n            btn.disabled = !canGoNext;\n        }\n    });\n}\n\nfunction handleSceneEntry(scene) {\n    if (!scene) return;\n    updateVillainMessage(scene.text);\n    \n    // === è‡ªå‹•æ’­æ”¾å°è©±éŸ³æª” ===\n    playSceneAudio(scene);\n    \n    if (!sceneHintsShown.has(scene.id)) {\n        sceneHintsShown.add(scene.id);\n        logSceneHints(scene.id);\n    }\n    syncNavigation();\n}\n\nwindow.advanceNarrative = function() {\n    const nextIndex = currentStoryIndex + 1;\n    if (nextIndex >= story.length) return;\n    if (nextIndex > furthestStoryIndex && !canAdvanceTo(nextIndex)) return;\n\n    currentStoryIndex = nextIndex;\n    furthestStoryIndex = Math.max(furthestStoryIndex, currentStoryIndex);\n    handleSceneEntry(story[currentStoryIndex]);\n}\n\nwindow.retreatNarrative = function() {\n    if (currentStoryIndex === 0) return;\n    currentStoryIndex--;\n    handleSceneEntry(story[currentStoryIndex]);\n}\n\nfunction checkNarrativeTrigger(levelId) {\n    const scene = story[currentStoryIndex];\n    \n    // æ”¯æ´å–®ä¸€è§¸ç™¼æ¢ä»¶ (triggerLevel) æˆ–å¤šé‡è§¸ç™¼æ¢ä»¶ (triggerLevels)\n    const isTriggered = scene.triggerLevel === levelId || \n                       (scene.triggerLevels && scene.triggerLevels.includes(levelId));\n    \n    if (scene && isTriggered) {\n        syncNavigation();\n        showMessage('success', 'é§­å®¢å·²è¢«é€¼å…¥çµ•å¢ƒï¼é»æ“Šå³ä¸‹è§’ç®­é ­ç¹¼çºŒè¿½æ“Šï¼');\n    }\n}\n\n// ==================== Sidebar Logic ====================\nlet isSidebarExpanded = false;\nwindow.toggleSidebar = function() {\n    isSidebarExpanded = !isSidebarExpanded;\n    const sidebar = $('#mission-sidebar');\n    const icon = $('#sidebar-icon');\n    \n    if (isSidebarExpanded) {\n        sidebar.classList.remove('-translate-x-full');\n        sidebar.classList.add('translate-x-0');\n        icon.textContent = 'chevron_left';\n    } else {\n        sidebar.classList.add('-translate-x-full');\n        sidebar.classList.remove('translate-x-0');\n        icon.textContent = 'chevron_right';\n    }\n}\n\n// ==================== Data & State ====================\nconst challenges = [\n    { \n        id: 1, \n        title: 'éš±å½¢è¨ˆæ™‚å™¨', \n        desc: 'Console é¢æ¿', \n        icon: 'terminal', \n        color: 'blue', \n        fragment: 'Dev',\n        completed: false,\n        hint: 'é–‹å•Ÿ Consoleï¼Œé»æ“Šçœ¼ç›åœ–ç¤º (Create Live Expression)ï¼Œè¼¸å…¥ \"window.game.timer\"',\n        knowledge: `\n            <h2 class=\"text-2xl font-bold text-blue-400 mb-4\">Console: Log Methods & Live Expressions</h2>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼šå‹•æ…‹è§€æ¸¬ vs éœæ…‹ç´€éŒ„</h3>\n                <p class=\"text-gray-400\">Console ä¸åƒ…åƒ…æ˜¯ log çš„è¼¸å‡ºåœ°ã€‚é€éä¸åŒçš„å·¥å…·ï¼Œæˆ‘å€‘å¯ä»¥é¸æ“‡è§€å¯Ÿ \"ç•¶ä¸‹ç¬é–“\" çš„ç‹€æ…‹ï¼Œæˆ–æ˜¯ \"æŒçºŒç›£æ§\" æ•¸å€¼çš„è®ŠåŒ–ã€‚</p>\n            </div>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">âš–ï¸ åŒæ€§è³ªæ¯”è¼ƒï¼šè§€æ¸¬æ–¹å¼å·®ç•°</h3>\n                <ul class=\"list-disc list-inside text-gray-400 space-y-1\">\n                    <li><strong>console.log()ï¼š</strong>éœæ…‹å¿«ç…§ã€‚ç´€éŒ„çš„æ˜¯ç¨‹å¼åŸ·è¡Œé‚£ä¸€ç¬é–“çš„è®Šæ•¸ç‹€æ…‹ï¼ˆä½†è¦æ³¨æ„ç‰©ä»¶åƒè€ƒç‰¹æ€§ï¼‰ï¼Œé©åˆæŸ¥çœ‹æ­·å²è»Œè·¡ã€‚</li>\n                    <li><strong>Live Expression (çœ¼ç›åœ–ç¤º)ï¼š</strong>å‹•æ…‹ç›£æ§ã€‚è¡¨é”å¼æœƒé‡˜é¸åœ¨ Console é ‚éƒ¨ï¼Œéš¨æ™‚è‡ªå‹•æ›´æ–°ä¸¦é¡¯ç¤º\"ç•¶å‰æœ€æ–°\"çš„å€¼ï¼Œé©åˆç›£æ§è®ŠåŒ–çš„ç‹€æ…‹ï¼ˆå¦‚è¨ˆæ™‚å™¨ã€åº§æ¨™ï¼‰ã€‚</li>\n                </ul>\n            </div>\n        `\n    },\n    { \n        id: 2, \n        title: 'ç¢ç‰‡æœå°‹', \n        desc: 'Application é¢æ¿', \n        icon: 'storage', \n        color: 'purple', \n        fragment: 'Tools', \n        completed: false, \n        hint: 'å¯†ç¢¼ç¢ç‰‡åˆ†æ•£åœ¨ 4 å€‹å„²å­˜ä½ç½®ï¼šCookiesã€Local Storageã€Session Storageã€IndexedDBã€‚æ”¶é›† 4 å€‹æç¤ºä¸¦çµ„åˆæˆå®Œæ•´ç¢ç‰‡ï¼Œç„¶å¾Œå‘¼å« window.game.verifyLevel2(\"ç¢ç‰‡\") é©—è­‰',\n        knowledge: `\n            <h2 class=\"text-2xl font-bold text-purple-400 mb-4\">Application: Storage Strategies</h2>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼šå®¢æˆ¶ç«¯å„²å­˜æ©Ÿåˆ¶</h3>\n                <p class=\"text-gray-400\">ç€è¦½å™¨æä¾›äº†å¤šç¨®å„²å­˜è³‡æ–™çš„æ–¹å¼ï¼Œæ¯ç¨®æ–¹å¼éƒ½æœ‰å…¶ç‰¹å®šçš„ç”¨é€”ã€å®¹é‡é™åˆ¶èˆ‡ç”Ÿå‘½é€±æœŸã€‚</p>\n            </div>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">âš–ï¸ åŒæ€§è³ªæ¯”è¼ƒï¼šå„²å­˜æ–¹æ¡ˆå·®ç•°</h3>\n                <ul class=\"list-disc list-inside text-gray-400 space-y-1\">\n                    <li><strong>Cookiesï¼š</strong>å®¹é‡æ¥µå° (4KB)ï¼Œæ¯æ¬¡ HTTP è«‹æ±‚éƒ½æœƒè‡ªå‹•å¤¾å¸¶ï¼Œä¸»è¦ç”¨æ–¼ä¼ºæœå™¨é©—è­‰èˆ‡ç‹€æ…‹ç¶­æŒã€‚</li>\n                    <li><strong>Local Storageï¼š</strong>å®¹é‡è¼ƒå¤§ (5-10MB)ï¼Œæ°¸ä¹…å„²å­˜ç›´åˆ°è¢«æ¸…é™¤ï¼Œç´”å®¢æˆ¶ç«¯å­˜å–ï¼Œé©åˆå„²å­˜ä½¿ç”¨è€…åå¥½è¨­å®šã€‚</li>\n                    <li><strong>Session Storageï¼š</strong>å®¹é‡åŒ Local Storageï¼Œä½†ç”Ÿå‘½é€±æœŸåƒ…é™æ–¼ã€Œç•¶å‰åˆ†é ã€ã€‚åˆ†é é—œé–‰å³æ¶ˆå¤±ï¼Œé©åˆæš«å­˜è¡¨å–®è³‡æ–™ã€‚</li>\n                    <li><strong>IndexedDBï¼š</strong>éåŒæ­¥ã€ç‰©ä»¶å°å‘çš„è³‡æ–™åº«ã€‚å®¹é‡å¤§ä¸”æ”¯æ´ç´¢å¼•èˆ‡äº¤æ˜“ (Transaction)ï¼Œé©åˆå„²å­˜é›¢ç·šæ‡‰ç”¨ (PWA) çš„å¤§é‡çµæ§‹åŒ–è³‡æ–™ã€‚</li>\n                </ul>\n            </div>\n        `\n    },\n    { \n        id: 3, \n        title: 'æ¸²æŸ“å£“åŠ›', \n        desc: 'Performance é¢æ¿', \n        icon: 'speed', \n        color: 'yellow', \n        fragment: '20', \n        completed: false,\n        hint: 'é–‹å•Ÿ Performance é¢æ¿éŒ„è£½ï¼Œæ‰¾å‡ºé•·æ¢çš„ç´…è‰² taskï¼Œå°‹æ‰¾ window.stopLag() å‡½å¼',\n        knowledge: `\n            <h2 class=\"text-2xl font-bold text-yellow-400 mb-4\">Performance: Runtime Metrics</h2>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼šåŸ·è¡Œæˆæœ¬åˆ†æ (Flame Chart)</h3>\n                <p class=\"text-gray-400\">æ•ˆèƒ½é¢æ¿çš„ç«ç„°åœ–é€éé¡è‰²å€åˆ†ä¸åŒçš„ç€è¦½å™¨å·¥ä½œã€‚å„ªåŒ–çš„ç¬¬ä¸€æ­¥æ˜¯è­˜åˆ¥å“ªç¨®é¡è‰²çš„å·¥ä½œä½”ç”¨äº†ä¸»åŸ·è¡Œç·’ (Main Thread) çš„æ™‚é–“ã€‚</p>\n            </div>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">âš–ï¸ åŒæ€§è³ªæ¯”è¼ƒï¼šä»»å‹™é¡å‹ (é¡è‰²) å·®ç•°</h3>\n                <ul class=\"list-disc list-inside text-gray-400 space-y-1\">\n                    <li><strong><span class=\"text-yellow-400\">é»ƒè‰² (Scripting)</span>ï¼š</strong>JavaScript åŸ·è¡Œã€‚åŒ…å«äº‹ä»¶è™•ç†ã€API å‘¼å«ã€é‚è¼¯é‹ç®—ã€‚å„ªåŒ–æ–¹å‘ï¼šCode Splitting, Web Workers, æ¼”ç®—æ³•å„ªåŒ–ã€‚</li>\n                    <li><strong><span class=\"text-purple-400\">ç´«è‰² (Rendering)</span>ï¼š</strong>æ¨£å¼è¨ˆç®— (Recalculate Style) èˆ‡ä½ˆå±€ (Layout/Reflow)ã€‚å„ªåŒ–æ–¹å‘ï¼šæ¸›å°‘ DOM æ“ä½œ, é¿å… Layout Thrashingã€‚</li>\n                    <li><strong><span class=\"text-green-400\">ç¶ è‰² (Painting)</span>ï¼š</strong>ç¹ªè£½èˆ‡åˆæˆ (Paint & Composite)ã€‚å„ªåŒ–æ–¹å‘ï¼šä½¿ç”¨å·²æå‡çš„åœ–å±¤ (GPU åŠ é€Ÿ), æ¸›å°‘é‡ç¹ªå€åŸŸã€‚</li>\n                </ul>\n            </div>\n        `\n    },\n    { \n        id: 4, \n        title: 'ç¶²è·¯é›œè¨Š', \n        desc: 'Network é¢æ¿', \n        icon: 'wifi', \n        color: 'green', \n        fragment: '26', \n        completed: false, \n        hint: 'æ­¥é©Ÿï¼š1) Block é »ç¹çš„é›œè¨Šè«‹æ±‚ 2) æ‰¾åˆ°æˆåŠŸçš„ hint-override.jsonï¼ŒæŸ¥çœ‹ Response 3) ä½¿ç”¨ Local Overrides override /secret-data.json 4) é‡æ–°è¼‰å…¥é é¢ï¼Œéš±è—ç¢ç‰‡æœƒå‡ºç¾',\n        knowledge: `\n            <h2 class=\"text-2xl font-bold text-green-400 mb-4\">Network: Request Interception</h2>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼šç¶²è·¯è¡Œç‚ºä¿®æ”¹</h3>\n                <p class=\"text-gray-400\">ä¸éœ€ç­‰å¾…å¾Œç«¯ API ä¿®æ”¹ï¼Œå‰ç«¯é–‹ç™¼è€…å¯ä»¥ç›´æ¥åœ¨ç€è¦½å™¨å±¤é¢ä»‹å…¥èˆ‡ä¿®æ”¹ç¶²è·¯è«‹æ±‚ï¼Œä»¥æ¨¡æ“¬å„ç¨®æƒ…å¢ƒã€‚</p>\n            </div>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">âš–ï¸ åŒæ€§è³ªæ¯”è¼ƒï¼šä»‹å…¥ç­–ç•¥å·®ç•°</h3>\n                <ul class=\"list-disc list-inside text-gray-400 space-y-1\">\n                    <li><strong>Block Request URL (é˜»æ“‹)ï¼š</strong>å®Œå…¨é˜»æ­¢è«‹æ±‚ç™¼é€ã€‚æ¨¡æ“¬è³‡æºéºå¤±ã€ä¼ºæœå™¨æ›æ‰æˆ–æ˜¯ç¬¬ä¸‰æ–¹è¿½è¹¤è…³æœ¬è¢«é˜»æ“‹çš„æƒ…å¢ƒã€‚(ç ´å£æ€§æ¸¬è©¦)</li>\n                    <li><strong>Network Throttling (ç¯€æµ)ï¼š</strong>é™åˆ¶é »å¯¬èˆ‡å»¶é²ã€‚æ¨¡æ“¬ 3G/4G æ…¢é€Ÿç¶²è·¯æˆ–é›¢ç·šç‹€æ…‹ï¼Œæ¸¬è©¦è¼‰å…¥é«”é©—èˆ‡ Timeout è™•ç†ã€‚(æ•ˆèƒ½æ¸¬è©¦)</li>\n                    <li><strong>Local Overrides (è¦†å¯«)ï¼š</strong>æ””æˆªè«‹æ±‚ä¸¦è¿”å›æœ¬åœ°å®šç¾©çš„å…§å®¹ã€‚æ¨¡æ“¬ API å›å‚³ç‰¹å®šè³‡æ–™ï¼ˆå¦‚éŒ¯èª¤è¨Šæ¯ã€ç‰¹å®šé‚Šç•Œå€¼ï¼‰ï¼Œå¾è€Œæ¸¬è©¦å‰ç«¯é‚è¼¯ã€‚(åŠŸèƒ½æ¸¬è©¦/Mocking)</li>\n                </ul>\n            </div>\n        `\n    },\n    { \n        id: 5, \n        title: 'é‚è¼¯åŠ«æŒ', \n        desc: 'Sources é¢æ¿', \n        icon: 'code', \n        color: 'red', \n        fragment: null, \n        completed: false, \n        hint: 'é€™ä¸€æ­¥æ²’æœ‰å¯†ç¢¼ç¢ç‰‡ï¼Œä½ çš„ä»»å‹™æ˜¯è®“ [ç·Šæ€¥è§£é™¤] æŒ‰éˆ•ç”Ÿæ•ˆã€‚é–‹å•Ÿ Sources é¢æ¿ï¼ŒDebug submitPassword å‡½å¼ã€‚',\n        knowledge: `\n            <h2 class=\"text-2xl font-bold text-red-500 mb-4\">Sources: Breakpoint Strategies</h2>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼šä¸­æ–·é»é¡å‹</h3>\n                <p class=\"text-gray-400\">Debug ä¸åªæ˜¯åœ¨æŸä¸€è¡Œæš«åœã€‚å–„ç”¨ä¸åŒé¡å‹çš„æ–·é»ï¼Œå¯ä»¥ç²¾æº–æ•æ‰å•é¡Œç™¼ç”Ÿçš„ç¬é–“ï¼Œéæ¿¾ä¸å¿…è¦çš„é›œè¨Šã€‚</p>\n            </div>\n            \n            <div class=\"mb-4\">\n                <h3 class=\"text-lg font-semibold text-gray-200 mb-2\">âš–ï¸ åŒæ€§è³ªæ¯”è¼ƒï¼šæ–·é»è§¸ç™¼æ™‚æ©Ÿ</h3>\n                <ul class=\"list-disc list-inside text-gray-400 space-y-1\">\n                    <li><strong>Line Breakpoint (è¡Œæ–·é»)ï¼š</strong>æœ€åŸºç¤çš„æ–·é»ã€‚åŸ·è¡Œåˆ°è©²è¡Œç¨‹å¼ç¢¼æ™‚æš«åœã€‚</li>\n                    <li><strong>Conditional Breakpoint (æ¢ä»¶æ–·é»)ï¼š</strong>\"åªæœ‰ç•¶...\"æ‰æš«åœã€‚ä¾‹å¦‚ <code>id === 'bug'</code>ã€‚é©åˆåœ¨è¿´åœˆæˆ–é »ç¹è§¸ç™¼çš„äº‹ä»¶ä¸­éæ¿¾é›œè¨Šï¼Œå¤§å¹…ç¯€çœ Debug æ™‚é–“ã€‚</li>\n                    <li><strong>DOM Breakpointï¼š</strong>ç•¶ HTML å…ƒç´ è¢«ä¿®æ”¹ï¼ˆå±¬æ€§è®Šæ›´ã€å­ç¯€é»ç§»é™¤ï¼‰æ™‚æš«åœã€‚é©åˆå°‹æ‰¾ \"æ˜¯èª°å·å·æ”¹äº†æˆ‘çš„ä»‹é¢ï¼Ÿ\" çš„ UI Bugã€‚</li>\n                    <li><strong>XHR/Fetch Breakpointï¼š</strong>ç•¶ç‰¹å®š URL çš„ç¶²è·¯è«‹æ±‚ç™¼é€æ™‚æš«åœã€‚é©åˆè¿½è¹¤è«‹æ±‚ç™¼é€çš„èµ·é»èˆ‡å †ç–Šã€‚</li>\n                </ul>\n            </div>\n        `\n    }\n];\n\n// ==================== UI Rendering ====================\nfunction renderChallenges() {\n    const lists = $$('.challenge-list'); // Modified to return NodeList\n    if (!lists.length) return;\n    \n    // Create HTML logic once\n    const htmlContent = challenges.map(c => `\n        <div class=\"challenge-item p-3 rounded border-l-2 font-mono text-xs text-gray-300 hover:bg-${c.color}-900/10 transition-all duration-300 flex justify-between items-center group ${c.completed ? `bg-green-900/20 border-green-500 opacity-80` : `bg-[#1f242d] border-${c.color}-500`}\" data-id=\"${c.id}\">\n            <div class=\"flex-grow\">\n                <div class=\"flex items-center gap-2 mb-1 text-gray-500 text-[10px]\">\n                    <span class=\"material-icons text-[10px] ${c.completed ? 'text-green-500' : ''}\">${c.icon}</span> \n                    LEVEL ${c.id}\n                </div>\n                <div class=\"font-bold text-${c.color}-300\">${c.title}</div>\n                <div class=\"text-[10px] opacity-70\">${c.desc}</div>\n                ${c.completed && c.fragment ? `<div class=\"mt-1 text-green-400 font-bold bg-black/30 inline-block px-1 rounded\">ç¢ç‰‡: ${c.fragment}</div>` : ''}\n            </div>\n            \n            <div class=\"flex gap-1 opacity-100 group-hover:opacity-100 transition-opacity\">\n                 <button onclick=\"showHint(${c.id})\" class=\"p-1.5 hover:bg-white/10 rounded text-yellow-500\" title=\"æç¤º\">\n                    <span class=\"material-icons text-sm\">lightbulb</span>\n                 </button>\n                 <button onclick=\"openKnowledge(${c.id})\" class=\"p-1.5 hover:bg-white/10 rounded text-blue-400\" title=\"çŸ¥è­˜é»\">\n                    <span class=\"material-icons text-sm\">menu_book</span>\n                 </button>\n                 <div class=\"w-6 flex items-center justify-center\">\n                    ${c.completed ? '<span class=\"material-icons text-green-500 text-sm animate-bounce\">check_circle</span>' : ''}\n                 </div>\n            </div>\n        </div>\n    `).join('');\n\n    // Apply to ALL lists (Mobile and Desktop)\n    lists.forEach(list => {\n        list.innerHTML = htmlContent;\n    });\n}\n\nfunction markChallengeComplete(id) {\n    const challenge = challenges.find(c => c.id === id);\n    if (challenge && !challenge.completed) {\n        challenge.completed = true;\n        renderChallenges();\n        checkNarrativeTrigger(id);\n        syncNavigation();\n        if (id === 1) {\n            updateTimerDisplay();\n        } else if (id === 2) {\n            scheduleLagSequence();\n        } else if (id === 3) {\n            startNetworkChaos();\n        }\n        \n        if (challenge.fragment) {\n             showMessage('success', `å–å¾—å¯†ç¢¼ç¢ç‰‡: [ ${challenge.fragment} ]`);\n        }\n    }\n}\n\n// ==================== Modal Logic ====================\nwindow.openKnowledge = function(id) {\n    const challenge = challenges.find(c => c.id === id);\n    if (!challenge) return;\n    \n    const modal = $('#knowledge-modal');\n    const content = $('#modal-content');\n    content.innerHTML = challenge.knowledge;\n    modal.classList.remove('hidden', 'pointer-events-none');\n    setTimeout(() => modal.classList.remove('opacity-0'), 10);\n    modal.querySelector('div').classList.remove('scale-95');\n    modal.querySelector('div').classList.add('scale-100');\n}\n\nwindow.closeModal = function() {\n    const modal = $('#knowledge-modal');\n    modal.classList.add('opacity-0');\n    modal.querySelector('div').classList.add('scale-95');\n    modal.querySelector('div').classList.remove('scale-100');\n    setTimeout(() => modal.classList.add('hidden', 'pointer-events-none'), 300);\n}\n\n// === Close Modal on Background Click ===\nwindow.closeModalOnBackdrop = function(event) {\n    if (event.target.id === 'knowledge-modal') {\n        closeModal();\n    }\n}\n\nwindow.showHint = function(id) {\n    const challenge = challenges.find(c => c.id === id);\n    if (challenge) showMessage('info', `æç¤º: ${challenge.hint}`);\n}\n\n// ==================== Level Logic ====================\n\nfunction formatTime(totalSeconds) {\n    const safeSeconds = Math.max(0, Math.floor(totalSeconds || 0));\n    const hours = String(Math.floor(safeSeconds / 3600)).padStart(2, '0');\n    const minutes = String(Math.floor((safeSeconds % 3600) / 60)).padStart(2, '0');\n    const seconds = String(safeSeconds % 60).padStart(2, '0');\n    return `${hours}:${minutes}:${seconds}`;\n}\n\nfunction generateFakeTime() {\n    const glitchTokens = ['##', '??', '--', '88', '!!', '%%'];\n    const segment = () => {\n        if (Math.random() > 0.6) {\n            return glitchTokens[Math.floor(Math.random() * glitchTokens.length)];\n        }\n        return String(Math.floor(Math.random() * 90)).padStart(2, '0');\n    };\n    return `${segment()}:${segment()}:${segment()}`;\n}\n\nfunction updateTimerDisplay(overrideText) {\n    const timerEl = $('#timer');\n    if (!timerEl) return;\n\n    let displayText = overrideText;\n    if (!displayText) {\n        const levelOne = challenges.find(c => c.id === 1);\n        if (levelOne && levelOne.completed) {\n            displayText = formatTime(window.game._internalTimer);\n        } else {\n            displayText = generateFakeTime();\n        }\n    }\n\n    timerEl.textContent = displayText;\n    timerEl.dataset.text = displayText;\n}\n\n// å…ˆåˆå§‹åŒ– window.game ç‰©ä»¶\nwindow.game = { timeLeft: 1200, _internalTimer: 1200 };\n\n// --- Manual Fragment Verification (Level 2 & 4) ---\nwindow.game.foundFragment = function(levelId, password) {\n    const challenge = challenges.find(c => c.id === levelId);\n    \n    if (!challenge) {\n        console.log('%câŒ éŒ¯èª¤: ç„¡æ•ˆçš„é—œå¡ ID', 'color: #ef4444; font-size: 14px; font-weight: bold;');\n        return;\n    }\n    \n    if (challenge.completed) {\n        console.log(`%câœ… é—œå¡ ${levelId} å·²ç¶“å®Œæˆäº†ï¼`, 'color: #10b981; font-size: 14px;');\n        return;\n    }\n    \n    // é©—è­‰å¯†ç¢¼\n    if (password !== challenge.fragment) {\n        console.log('%câŒ å¯†ç¢¼éŒ¯èª¤ï¼', 'color: #ef4444; font-size: 16px; font-weight: bold;');\n        console.log(`%cæç¤º: ä»”ç´°æª¢æŸ¥ ${challenge.desc} ä¸­çš„è³‡æ–™...`, 'color: #f59e0b; font-size: 14px;');\n        return;\n    }\n    \n    // å¯†ç¢¼æ­£ç¢º\n    console.log('%cğŸ‰ ç­”å°äº†ï¼', 'color: #10b981; font-size: 18px; font-weight: bold;');\n    console.log(`%cç¢ç‰‡å·²è¨˜éŒ„: ${password}`, 'color: #3b82f6; font-size: 14px; background: #1f2937; padding: 4px 8px; border-radius: 4px;');\n    markChallengeComplete(levelId);\n}\n\n// --- Level 1: Console ---\nlet observation = { count: 0, lastTime: 0, isConfirmed: false };\nObject.defineProperty(window.game, 'timer', {\n    get: function() {\n        const now = Date.now();\n        if (now - observation.lastTime < 500) observation.count++;\n        else observation.count = 1;\n        observation.lastTime = now;\n\n        if (observation.count >= 5 && !observation.isConfirmed) {\n            observation.isConfirmed = true;\n            console.log('%c ğŸ‰ åµæ¸¬æˆåŠŸï¼å–å¾—ç¢ç‰‡: Dev', 'color: #00ff00; font-size: 16px;');\n            markChallengeComplete(1);\n        }\n        return this._internalTimer;\n    }\n});\nsetInterval(() => {\n    if (window.game._internalTimer > 0) window.game._internalTimer--;\n    updateTimerDisplay();\n}, 1000);\n\n// --- Level 3: Performance ---\nconst perfIndicator = $('#performance-indicator');\nconst fuseSparkEl = document.getElementById('fuse-spark'); // æ–°å¢ï¼šå¼•ä¿¡ç«èŠ±å…ƒç´ \nlet lagSequenceScheduled = false;\n\n// åˆå§‹åŒ–ï¼šç§»é™¤ CSS å‹•ç•«ï¼Œæ”¹ç”¨ JS é©…å‹•ä»¥ç¢ºä¿å¡é “æ•ˆæœ\nlet animFrameId;\nif (perfIndicator) {\n    perfIndicator.style.opacity = '0.8'; \n    perfIndicator.classList.remove('pointer-events-none');\n    \n    // JS Driven Animation State (Time Based to match CSS ease-in-out)\n    const startTime = Date.now();\n    const duration = 3000; // 3s per direction\n    \n    function animateIndicator() {\n        const now = Date.now();\n        const elapsed = now - startTime;\n        const cycleTime = elapsed % (duration * 2); // 6s cycle\n        \n        let progress; // 0 to 1\n        let isForward = cycleTime < duration;\n        \n        if (isForward) {\n            // Forward (0 -> 1)\n            progress = cycleTime / duration;\n        } else {\n            // Backward (1 -> 0)\n            progress = 1 - ((cycleTime - duration) / duration);\n        }\n        \n        // Easing: Ease-in-out approximation using Cosine\n        // 0.5 * (1 - cos(p * PI)) maps 0->0, 0.5->0.5, 1->1 with smooth curve\n        const easedProgress = 0.5 * (1 - Math.cos(progress * Math.PI));\n        \n        // Interpolate values\n        // Range: -180px to 180px\n        const translateX = -180 + (360 * easedProgress);\n        // Range: 0deg to 360deg\n        const rotation = 360 * easedProgress;\n\n        // Apply styles directly\n        // Inner Element: Spin & Translate\n        // Note: CSS uses transform to center (-50%, -50%). We must keep that.\n        perfIndicator.style.transform = `translate(-50%, -50%) translateX(${translateX}px) rotate(${rotation}deg)`;\n        perfIndicator.style.animation = 'none'; // Ensure CSS is off\n\n        animFrameId = requestAnimationFrame(animateIndicator);\n    }\n    \n    // Start animation loop\n    animFrameId = requestAnimationFrame(animateIndicator);\n}\n\nfunction scheduleLagSequence() {\n    if (lagSequenceScheduled) return;\n    lagSequenceScheduled = true;\n    setTimeout(() => {\n        if (typeof window.startLag === 'function') {\n            window.startLag();\n        }\n    }, 800);\n}\n\nwindow.startLag = function() {\n    // === èˆŠçš„æ—‹è½‰åœ“åœˆæ•ˆæœï¼ˆç¾åœ¨ä½œç‚ºæ•ˆèƒ½æŒ‡æ¨™ï¼‰ ===\n    // ä¿æŒé¡¯ç¤ºï¼Œå› ç‚ºå®ƒç¾åœ¨æ˜¯æˆ‘å€‘ observation çš„é‡é»\n    \n    // === æ–°çš„å¼•ä¿¡ç«èŠ±å¡é “æ•ˆæœ ===\n    if (fuseSparkEl) {\n        fuseSparkEl.classList.add('lag-active');\n    }\n    \n    // æ­å–œä½ æ‰¾åˆ°å•é¡Œäº†ï¼è«‹åœ¨ console åŸ·è¡Œ window.stopLag() ä¾†åœæ­¢\n    // å¢åŠ è¨ˆç®—é‡ä»¥ç¢ºä¿ä¸»åŸ·è¡Œç·’å¡é “ï¼Œå°è‡´æ—‹è½‰å‹•ç•«æ‰å¹€\n    window.lagInterval = setInterval(() => {\n        const start = Date.now();\n        // å¢åŠ é˜»å¡æ™‚é–“åˆ° 180ms (è¶…é 16.7ms å°±æœƒæ‰å¹€, 180ms æœƒéå¸¸æ˜é¡¯)\n        while (Date.now() - start < 180) { \n            Math.sqrt(Math.random()); \n        }\n    }, 200); // æ¯ 200ms åŸ·è¡Œä¸€æ¬¡ï¼Œå¹¾ä¹ä½”æ»¿æ™‚é–“\n}\n\nwindow.stopLag = function() {\n    clearInterval(window.lagInterval);\n    \n    // === ç§»é™¤å¡é “æ•ˆæœï¼Œé¡¯ç¤ºä¿®å¾©ç‹€æ…‹ ===\n    if (fuseSparkEl) {\n        fuseSparkEl.classList.remove('lag-active');\n        fuseSparkEl.classList.add('fixed-state'); // ç¶ è‰²æ¿¾é¡\n    }\n    \n    // æŒ‡ç¤ºå™¨è®Šç‚ºç¶ è‰²ï¼Œè¡¨ç¤ºæ•ˆèƒ½å„ªåŒ–å®Œæˆ\n    if (perfIndicator) {\n        perfIndicator.style.borderColor = '#10b981'; // green-500\n        perfIndicator.style.boxShadow = '0 0 15px #10b981';\n    }\n    \n    console.log('âœ… æ•ˆèƒ½å„ªåŒ–å®Œæˆï¼å–å¾—ç¢ç‰‡: 20'); \n    markChallengeComplete(3);\n}\n\n// --- Level 2 (App) & 4 (Network) ---\n// åˆå§‹åŒ– IndexedDB\nasync function initIndexedDB() {\n    return new Promise((resolve, reject) => {\n        const request = indexedDB.open('DevToolsDB', 1);\n        \n        request.onerror = () => reject(request.error);\n        \n        request.onsuccess = () => {\n            const db = request.result;\n            const transaction = db.transaction(['hints'], 'readwrite');\n            const store = transaction.objectStore('hints');\n            store.put({ id: 'hint_4', value: 'ls' });\n            \n            transaction.oncomplete = () => {\n                db.close();\n                resolve();\n            };\n        };\n        \n        request.onupgradeneeded = (event) => {\n            const db = event.target.result;\n            if (!db.objectStoreNames.contains('hints')) {\n                db.createObjectStore('hints', { keyPath: 'id' });\n            }\n        };\n    });\n}\n\nfunction initStorage() {\n    // Cookies - æç¤º 1\n    document.cookie = `hint_1=T; path=/`; \n    // Local Storage - æç¤º 2\n    localStorage.setItem('hint_2', 'o'); \n    // Session Storage - æç¤º 3\n    sessionStorage.setItem('hint_3', 'o');\n    // IndexedDB - æç¤º 4 (ç•°æ­¥åˆå§‹åŒ–)\n    initIndexedDB().catch(err => console.error('IndexedDB init failed:', err));\n}\n\n// é—œå¡äºŒé©—è­‰å‡½å¼\nwindow.game.verifyLevel2 = function(answer) {\n    const correctAnswer = 'Tools';\n    \n    if (challenges[1].completed) {\n        console.log('%câœ… é—œå¡äºŒå·²ç¶“å®Œæˆäº†ï¼', 'color: #10b981; font-size: 14px;');\n        return;\n    }\n    \n    if (answer !== correctAnswer) {\n        console.log('%câŒ ç­”æ¡ˆéŒ¯èª¤ï¼', 'color: #ef4444; font-size: 16px; font-weight: bold;');\n        console.log('%cè«‹ç¢ºèªä½ å·²ç¶“æ‰¾åˆ°æ‰€æœ‰ 4 å€‹å„²å­˜ä½ç½®çš„æç¤º...', 'color: #f59e0b; font-size: 13px;');\n        return;\n    }\n    \n    console.log('%cğŸ‰ ç­”å°äº†ï¼', 'color: #10b981; font-size: 18px; font-weight: bold;');\n    console.log('%cç¢ç‰‡å·²è¨˜éŒ„: Tools', 'color: #3b82f6; font-size: 14px; background: #1f2937; padding: 4px 8px; border-radius: 4px;');\n    markChallengeComplete(2);\n};\n\nlet noiseInterval;\nlet hintOverrideTimeout;\nlet secretDataInterval;\nlet networkChaosStarted = false;\nlet isSystemIntegrityCheckPassed = false;\n\nfunction startNetworkChaos() {\n    if (networkChaosStarted) return;\n    networkChaosStarted = true;\n\n    noiseInterval = setInterval(() => {\n        fetch(toAssetUrl('noise-signal-404.json'))\n            .then(() => {\n                // è«‹æ±‚æˆåŠŸç™¼å‡ºï¼ŒæŒçºŒè£½é€ å™ªéŸ³\n            })\n            .catch(() => {\n                // åªæœ‰è¢« DevTools Block æ™‚æ‰æœƒé€²å…¥é€™è£¡\n                console.log('%cğŸ‰ é›œè¨Šå·²æ¶ˆé™¤ï¼(åµæ¸¬åˆ° Network Block)', 'color: #10b981; font-size: 14px; font-weight: bold;');\n                clearInterval(noiseInterval);\n                \n                // åœ¨æˆåŠŸ Block å¾Œæ‰ç™¼é€ Hint\n                console.log('%cğŸ’¡ é›œè¨Šæ¶ˆé™¤ï¼Œé—œéµè¨Šè™Ÿæµ®ç¾...', 'color: #fbbf24; font-size: 14px;');\n                 setTimeout(() => {\n                    fetch(toAssetUrl('hint-override.json')).then(r => r.json()).then(() => {\n                        // è®“ä½¿ç”¨è€…è‡ªè¡Œåœ¨ Network é¢æ¿ç™¼ç¾\n                    }).catch(() => {});\n                }, 1000);\n            });\n    }, 300);\n\n    // hintOverrideTimeout å·²æ•´åˆè‡³ä¸Šæ–¹ catch å€å¡Š\n\n    secretDataInterval = setInterval(async () => {\n        try {\n            const res = await fetch(toAssetUrl('api/secret-data.json'));\n            if (res.ok) {\n                const data = await res.json();\n                \n                // æª¢æŸ¥æ˜¯å¦æˆåŠŸè§£é– (status === 'unlocked')\n                if (data.status === 'unlocked' && data.SECRET_CODE_FRAGMENT) {\n                    const hiddenFragment = document.getElementById('hidden-fragment');\n                    if (hiddenFragment && hiddenFragment.classList.contains('hidden')) {\n                        hiddenFragment.classList.remove('hidden');\n                        console.log('%cğŸ‰ API Override æˆåŠŸï¼', 'color: #10b981; font-size: 16px; font-weight: bold;');\n                        console.log('%céš±è—çš„ç¢ç‰‡å·²ç¶“å‡ºç¾åœ¨é é¢ä¸Šäº†ï¼', 'color: #60a5fa; font-size: 14px;');\n                        \n                        // é¡¯ç¤ºæç¤ºå¡ç‰‡\n                        showMessage('success', `æˆåŠŸè§£é™¤é–å®šï¼å–å¾—å¯†ç¢¼ç¢ç‰‡: [ ${data.SECRET_CODE_FRAGMENT} ]`);\n                        \n                        // æ¨™è¨˜é—œå¡å®Œæˆ (å¦‚æœé‚„æ²’å®Œæˆ)\n                        // é€™è£¡å‡è¨­é€™å±¬æ–¼ Level 4 (Network) çš„ä¸€éƒ¨åˆ†æˆ–æ˜¯éš±è—ä»»å‹™\n                        // å¦‚æœæœ‰å°æ‡‰çš„ challenge IDï¼Œå¯ä»¥å‘¼å« markChallengeComplete\n                        \n                        clearInterval(secretDataInterval);\n                    }\n                }\n            }\n        } catch (e) {\n            // å¤±æ•—æˆ–å…¶ä»–éŒ¯èª¤ï¼Œç¹¼çºŒç­‰å¾…\n        }\n    }, 5000);\n}\n\n\n// --- Level 5 & Submission ---\nwindow.submitPassword = function() {\n    const input = $('#password-input');\n    const val = input.value.trim();\n    const correctPass = \"DevTools2026\";\n    \n    // æ¨™è¨˜ç”¨æˆ¶å·²å˜—è©¦è¼¸å…¥å¯†ç¢¼ï¼ˆç„¡è«–å°éŒ¯ï¼‰\n    if (currentStoryIndex === 10) {\n        story10PasswordAttempted = true;\n        if (furthestStoryIndex < 11) {\n            furthestStoryIndex = 11;\n            syncNavigation();\n        }\n    }\n    \n    if (val !== correctPass) {\n         showMessage('error', 'å¯†ç¢¼éŒ¯èª¤ï¼è«‹æª¢æŸ¥å„é—œå¡æ”¶é›†åˆ°çš„ç¢ç‰‡ (Dev...Tools...20...26)');\n         input.classList.add('animate-shake');\n         setTimeout(() => input.classList.remove('animate-shake'), 500);\n         return;\n    }\n\n    // âš ï¸ BUG: ç³»çµ±é©—è­‰é‚è¼¯éŒ¯èª¤ï¼\n    // ğŸ’¡ æç¤º: å°‡ä¸‹æ–¹çš„ false æ”¹æˆ true å³å¯è§£é–ç³»çµ±\n    if (isSystemIntegrityCheckPassed) {\n        markChallengeComplete(5);\n        showMessage('success', 'ğŸ‰ ç³»çµ±è§£é–æˆåŠŸï¼ç‚¸å½ˆå·²æ‹†é™¤ï¼');\n        const timerEl = $('#timer');\n        if (timerEl) timerEl.classList.add('text-green-500');\n        updateTimerDisplay('DEFUSED');\n        input.disabled = true;\n        input.classList.add('text-green-500', 'border-green-500');\n        $('#defuse-btn').classList.add('bg-green-500', 'hover:bg-green-600');\n        // è§£é–æœ€çµ‚å‹åˆ©å°è©±ï¼ˆStory ID 12ï¼‰ï¼Œè®“ç©å®¶è‡ªè¡Œé»æ“Šä¸‹ä¸€æ­¥\n        const finalStoryIndex = 12;\n        furthestStoryIndex = Math.max(furthestStoryIndex, finalStoryIndex);\n        syncNavigation();\n    } else {\n        // æ¨é€²åˆ°é—œå¡äº”æç¤ºå°è©±ï¼ˆStory ID 11ï¼‰\n        // å¦‚æœç•¶å‰æ˜¯åœ¨ã€Œè¼¸å…¥å¯†ç¢¼è©¦è©¦çœ‹ã€(ID 10)\n        if (currentStoryIndex === 10) {\n            // æ¨™è¨˜ç”¨æˆ¶å·²å˜—è©¦è¼¸å…¥å¯†ç¢¼\n            story10PasswordAttempted = true;\n            \n            // ä¸è‡ªå‹•æ¨é€²ï¼Œè€Œæ˜¯è§£é–ä¸‹ä¸€æ­¥ç®­é ­\n            if (furthestStoryIndex < 11) {\n                furthestStoryIndex = 11;\n                syncNavigation();\n                showMessage('error', 'âŒ é©—è­‰å¤±æ•—... ä½†ä¼¼ä¹è§¸ç™¼äº†ä»€éº¼ï¼Ÿ(é»æ“Šå³ä¸‹è§’ç®­é ­ç¹¼çºŒ)');\n            } else {\n                showMessage('error', 'âŒ é©—è­‰å¤±æ•—... (è«‹é»æ“Šå³ä¸‹è§’ç®­é ­ç¹¼çºŒ)');\n            }\n        } else if (currentStoryIndex === 11) {\n            // å¦‚æœå·²ç¶“åœ¨ ID 11ï¼Œåªé¡¯ç¤ºç°¡å–®éŒ¯èª¤ï¼Œä¸å†é‡è¤‡æ´—ç‰ˆ Console\n             showMessage('error', 'âŒ éŒ¯èª¤ï¼šç³»çµ±é‚è¼¯è¼ƒé©—å¤±æ•—ï¼');\n             // é€™è£¡ä¸éœ€ console.errorï¼Œå› ç‚º logSceneHints å·²ç¶“è™•ç†äº†\n        }\n    }\n}\n\n// ==================== Keyboard Shortcuts ====================\n// å³æ–¹å‘éµè§¸ç™¼é§­å®¢å°è©±ä¸‹ä¸€æ­¥\ndocument.addEventListener('keydown', function(e) {\n    const target = e.target;\n    const isEditable = target && (target.isContentEditable || target.tagName === 'INPUT' || target.tagName === 'TEXTAREA');\n    if (isEditable) return;\n\n    // ESC éµé—œé–‰ modal\n    if (e.key === 'Escape') {\n        const modal = $('#knowledge-modal');\n        if (modal && !modal.classList.contains('hidden')) {\n            e.preventDefault();\n            closeModal();\n            return;\n        }\n    }\n    \n    if (e.key === 'ArrowRight') {\n        if (canAdvanceFromCurrent()) {\n            e.preventDefault();\n            advanceNarrative();\n        }\n    } else if (e.code === 'Space') {\n        e.preventDefault();\n        playSceneAudio(story[currentStoryIndex]);\n    } else if (e.key === 'ArrowLeft') {\n        if (currentStoryIndex > 0) {\n            e.preventDefault();\n            window.retreatNarrative();\n        }\n    }\n});\n\n// Init\nwindow.addEventListener('DOMContentLoaded', () => {\n    renderChallenges();\n    initStorage();\n    handleSceneEntry(story[0]);\n    updateTimerDisplay();\n    \n    $('#password-input').addEventListener('keypress', (e) => {\n        if (e.key === 'Enter') window.submitPassword();\n    });\n});\n"],"names":["sceneAudio","baseAssetUrl","baseEnv","toAssetUrl","path","$","selector","$$","showMessage","type","text","messageEl","currentStoryIndex","furthestStoryIndex","sceneHintsShown","story10PasswordAttempted","story","updateVillainMessage","desktopMsg","mobileMsg","formattedText","playSceneAudio","scene","logSceneHints","sceneId","canAdvanceTo","index","nextScene","level","challenges","c","levelId","canAdvanceFromCurrent","nextIndex","syncNavigation","desktopNext","mobileNext","desktopPrev","mobilePrev","canGoPrev","canGoNext","btn","handleSceneEntry","checkNarrativeTrigger","isTriggered","isSidebarExpanded","sidebar","icon","renderChallenges","lists","htmlContent","list","markChallengeComplete","id","challenge","updateTimerDisplay","scheduleLagSequence","startNetworkChaos","modal","content","event","formatTime","totalSeconds","safeSeconds","hours","minutes","seconds","generateFakeTime","glitchTokens","segment","overrideText","timerEl","displayText","levelOne","password","observation","now","perfIndicator","fuseSparkEl","lagSequenceScheduled","animateIndicator","cycleTime","startTime","duration","progress","easedProgress","translateX","rotation","initIndexedDB","resolve","reject","request","db","transaction","initStorage","err","answer","correctAnswer","noiseInterval","secretDataInterval","networkChaosStarted","r","res","data","hiddenFragment","input","val","correctPass","target"],"mappings":"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"}